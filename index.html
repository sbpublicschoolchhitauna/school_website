<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>S.B. Public School — Modern Theme</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0f172a; --card:#0f172a; --muted:#94a3b8;
  --accent1:#06b6d4; --accent2:#7c3aed;
  --glass: rgba(255,255,255,0.06);
  --glass-2: rgba(255,255,255,0.03);
  --glass-border: rgba(255,255,255,0.08);
  --text:#e6eef8;
}
/* Light theme variables (will be toggled) */
:root.light{
  --bg: #f7fafc; --card:#ffffff; --muted:#6b7280;
  --accent1:#0ea5a4; --accent2:#6366f1;
  --glass: rgba(2,6,23,0.04); --glass-2: rgba(2,6,23,0.03);
  --glass-border: rgba(2,6,23,0.06);
  --text:#0b1220;
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;font-size:14px;background:linear-gradient(180deg,var(--bg),#071025);color:var(--text);-webkit-font-smoothing:antialiased}
.container{max-width:1100px;margin:14px auto;padding:16px}

/* Animated gradient header with glass cards */
.header{
  padding:20px;border-radius:14px;position:relative;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  box-shadow: 0 10px 30px rgba(2,6,23,0.4);
  overflow:hidden;
  transform:translateZ(0);
}
.header::after{
  content:""; position:absolute; inset:0; background:linear-gradient(120deg, rgba(255,255,255,0.02), transparent 30%); mix-blend-mode:overlay; pointer-events:none;
}
.header-inner{display:flex;flex-direction:column;align-items:center;gap:6px;text-align:center}
.header h1{margin:0;font-size:clamp(20px,4.5vw,32px);font-weight:800;letter-spacing:0.6px;color:white;text-shadow:0 2px 12px rgba(0,0,0,0.2)}
.header p{margin:0;color:rgba(255,255,255,0.92)}

/* animated shapes */
.float-shape{position:absolute;border-radius:50%;filter:blur(36px);opacity:0.5;mix-blend-mode:screen}
.s1{width:280px;height:280px;right:-80px;top:-60px;background:rgba(255,255,255,0.06);animation:float 10s ease-in-out infinite}
.s2{width:200px;height:200px;left:-60px;bottom:-40px;background:rgba(255,255,255,0.03);animation:float 12s ease-in-out infinite reverse}
@keyframes float{0%{transform:translateY(0) translateX(0)}50%{transform:translateY(-12px) translateX(6px)}100%{transform:translateY(0) translateX(0)}}

/* strip marquee (parallax-like) */
.strip-wrap{margin-top:14px;overflow:hidden;border-radius:10px;padding:8px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent)}
.strip{display:flex;gap:12px;white-space:nowrap;will-change:transform;align-items:center}

/* layout grid */
.grid{display:grid;grid-template-columns:1fr 360px;gap:16px;margin-top:16px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}

/* glass cards */
.card{background:linear-gradient(180deg,var(--glass),var(--glass-2));border:1px solid var(--glass-border);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.35);backdrop-filter: blur(6px)}

/* interactive */
.tabbar{display:flex;gap:8px;margin-bottom:10px}
.tab{padding:8px 12px;border-radius:999px;background:transparent;border:1px solid transparent;color:var(--text);cursor:pointer;font-weight:600;transition:all .22s;box-shadow:inset 0 0 0 0 transparent}
.tab.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 8px 24px rgba(124,58,237,0.18);color:#fff;transform:translateY(-2px)}

/* buttons */
.btn{padding:8px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent2),var(--accent1));color:white;cursor:pointer;font-weight:700;box-shadow:0 8px 18px rgba(2,6,23,0.28);transition:transform .15s}
.btn:active{transform:translateY(1px)}

/* responsive table container */
.table-wrap{overflow:auto;border-radius:10px;border:1px solid rgba(255,255,255,0.04);padding:6px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);max-height:420px}
table{width:100%;border-collapse:collapse;min-width:760px}
th,td{padding:10px 12px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.04)}
thead th{position:sticky;top:0;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);font-weight:700;color:var(--text)}

/* row hover highlight */
tbody tr{transition:background .12s,transform .12s}
tbody tr:hover{background:linear-gradient(90deg,rgba(255,255,255,0.02),transparent);transform:translateY(-2px)}

/* notification area */
.notify-wrap{height:220px;overflow:hidden;border-radius:10px}
.notify-list{position:relative;will-change:transform}
.notify-item{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);opacity:0;transform:translateY(8px);animation:fadeInUp .6s forwards}
@keyframes fadeInUp{to{opacity:1;transform:none}}

/* toggle theme */
.theme-toggle{position:fixed;right:18px;bottom:18px;background:var(--glass);border:1px solid var(--glass-border);padding:8px;border-radius:10px;cursor:pointer;z-index:9999;color:var(--text)}

/* subtle entrance */
.page-enter{opacity:0;transform:translateY(6px);animation:entrance .6s forwards}
@keyframes entrance{to{opacity:1;transform:none}}
</style>
</head>
<body class="page-enter">

<div class="container">

  <header class="header" role="banner" aria-label="School header">
    <div class="float-shape s1"></div>
    <div class="float-shape s2"></div>
    <div class="header-inner">
      <h1>S.B. PUBLIC SCHOOL</h1>
      <p>Village Chhitauna · Post Meghauli Kala · Pin Code 273304</p>
      <p class="meta-note">Principal — Mr. Gajendra Yadav Sir · Call: +91 6389259200 · Created By — Upendra Vishwakarma</p>
    </div>

    <div class="strip-wrap" style="margin-top:12px">
      <div id="schoolStrip" class="strip"></div>
    </div>
  </header>

  <main class="grid" style="margin-top:18px">
    <div>
      <section class="card">
        <h2 style="margin-bottom:8px">Student Details Lookup</h2>
        <div style="display:flex;gap:8px;margin-bottom:10px">
          <input id="admission" placeholder="Admission Number" style="flex:1;padding:10px;border-radius:8px;border:1px solid var(--glass-border);background:transparent;color:var(--text)">
          <button class="btn" onclick="searchStudent()">Search</button>
        </div>
        <div id="result"></div>
      </section>

      <section class="card" style="margin-top:12px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <h2 style="margin:0">Student Records</h2>
          <div style="display:flex;gap:8px">
            <button class="tab active" id="tabFee" onclick="showTab('fee')">Fee</button>
            <button class="tab" id="tabMarks" onclick="showTab('marks')">Marksheet</button>
          </div>
        </div>

        <div id="feeContainer" class="table-wrap">लोड हो रहा है...</div>
        <div id="marksContainer" class="table-wrap" style="display:none;margin-top:8px">लोड हो रहा है...</div>
      </section>
    </div>

    <aside>
      <section class="card">
        <h3 style="margin-top:0">Notifications</h3>
        <div id="notifyOuter" class="notify-wrap">
          <div id="notifs" class="notify-list"></div>
        </div>
      </section>

      <section class="card" style="margin-top:12px">
        <h3 style="margin-top:0">Quick Portals</h3>
        <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
          <a class="btn" href="#" target="_blank">Fee Portal</a>
          <a class="btn" href="#" target="_blank">Marksheet Portal</a>
        </div>
      </section>
    </aside>
  </main>

  <footer style="text-align:center;margin-top:18px;color:var(--muted)">
    © <span id="year"></span> S.B. PUBLIC SCHOOL — All Rights Reserved
  </footer>
</div>

<button id="themeToggle" class="theme-toggle">Toggle Theme</button>

<script>
const SHEET_ID = "1BtoDja9imrMyHMKt5oqSYoOzj9w2GWe13JcbRu1vWO8";
const NOTIF_SPEED = 0.4;
const HEADER_SPEED = 0.5;

/* tiny helpers */
function $(id){ return document.getElementById(id) }
function escapeHtml(s){ if(s===null||s===undefined) return ""; return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
async function loadSheetGviz(sheetName){ const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${encodeURIComponent(sheetName)}&tqx=out:json`; const res = await fetch(url); if(!res.ok) throw new Error('Network error: '+res.status); const txt = await res.text(); const jsonText = txt.replace(/^[^{]*/,'').replace(/\);\s*$/,''); return JSON.parse(jsonText); }
function maskLast4(v){ if(v==null) return ''; const s = String(v).replace(/\D/g,''); if(s.length<=4) return '****'+s; return '****'+s.slice(-4) }
function isMobileHeader(h){ return /mobile|phone|contact|mob/i.test(h) }
function isAadharHeader(h){ return /aadhar|aadhaar|uid/i.test(h) }

/* render table */
function renderTableTo(id, g){ const cols = (g.table.cols||[]).map(c=> (c.label||c.id||'').toString().trim()); const rows = (g.table.rows||[]).map(r=> r.c || []); const wrap = $(id); if(rows.length===0){ wrap.innerHTML='<div style="padding:12px;color:var(--muted)">कोई रिकॉर्ड नहीं मिला।</div>'; return } const table = document.createElement('table'); const thead = document.createElement('thead'); const trh = document.createElement('tr'); cols.forEach(h=>{ const th=document.createElement('th'); th.innerText=h||''; trh.appendChild(th) }); thead.appendChild(trh); table.appendChild(thead); const tbody=document.createElement('tbody'); rows.forEach(r=>{ const tr=document.createElement('tr'); for(let i=0;i<cols.length;i++){ const cell=r[i]; let v=''; if(cell){ if(cell.f!==undefined && String(cell.f).trim()!=='') v=String(cell.f).replace(/<[^>]*>/g,'').trim(); else if(cell.v!==undefined) v=cell.v } const header=cols[i]||''; if(isMobileHeader(header)) v=maskLast4(v); if(isAadharHeader(header)) v=maskLast4(v); const td=document.createElement('td'); td.innerText=v; tr.appendChild(td) } tbody.appendChild(tr) }); table.appendChild(tbody); wrap.innerHTML=''; wrap.appendChild(table) }

/* tabs */
function showTab(name){ $('feeContainer').style.display = name==='fee' ? 'block':'none'; $('marksContainer').style.display = name==='marks' ? 'block':'none'; $('tabFee').classList.toggle('active', name==='fee'); $('tabMarks').classList.toggle('active', name==='marks') }

/* search */
async function searchStudent(){ const adm = $('admission').value.trim(); if(!adm) return alert('Admission Number डालें'); try{ const data = await loadSheetGviz(\"Student's Details\"); const cols = (data.table.cols||[]).map(c=> (c.label||c.id||'').toString().trim()); const rows = (data.table.rows||[]).map(r=> r.c || []); const records = rows.map(cells=>{ const obj={}; for(let i=0;i<cols.length;i++){ const cell=cells[i]; let v=''; if(cell){ if(cell.v!==undefined) v=cell.v; else if(cell.f!==undefined) v=String(cell.f).replace(/<[^>]*>/g,'').trim(); } obj[cols[i]||('col'+i)]=v } return obj }); const admKeys=[\"Admission No.\",\"Adm. No.\",\"Admission Number\",\"Adm No\",\"Admission No\"]; const rec = records.find(r=> admKeys.some(k=> String((r[k]||'')).trim() === adm || String((r[k]||'')).trim() === ('0'+adm))); const out = $('result'); out.style.display='block'; if(!rec){ out.innerHTML='<div style=\"padding:12px;background:linear-gradient(90deg,rgba(255,255,255,0.02),transparent);border-radius:8px\">No details found.</div>'; return } const fields=[\"Student Name\",\"Father Name\",\"Mother Name\",\"Date of Birth\",\"Class\",\"Address\"]; let html='<div style=\"padding:10px;border-radius:8px;background:linear-gradient(90deg,rgba(255,255,255,0.02),transparent)\">'; fields.forEach(f=> html += `<div style=\"margin-bottom:8px\"><strong>${f}:</strong> ${escapeHtml(rec[f]||'')}</div>`); html += '</div>'; out.innerHTML = html }catch(e){ console.error(e); alert('Search में समस्या — console देखें।') } }

/* notifications vertical scroll (smooth) */
let notifRAF=null, notifPos=0;
function startNotifScroll(){ const wrap=$('notifs'); if(!wrap) return; cancelAnimationFrame(notifRAF); function step(){ notifPos -= NOTIF_SPEED; const half = wrap.scrollHeight/2||0; if(Math.abs(notifPos)>=half) notifPos=0; wrap.style.transform = `translateY(${notifPos}px)`; notifRAF = requestAnimationFrame(step) } step() }
function stopNotifScroll(){ if(notifRAF) cancelAnimationFrame(notifRAF); notifRAF=null }

/* header strip scroll */
let headerRAF=null, headerPos=0;
function startHeaderScroll(){ const strip = $('schoolStrip'); if(!strip) return; cancelAnimationFrame(headerRAF); function step(){ headerPos -= HEADER_SPEED; const half = strip.scrollWidth/2||0; if(Math.abs(headerPos)>=half) headerPos=0; strip.style.transform = `translateX(${headerPos}px)`; headerRAF = requestAnimationFrame(step) } step() }
function stopHeaderScroll(){ if(headerRAF) cancelAnimationFrame(headerRAF); headerRAF=null }

/* Build strip from Notification sheet */
async function buildStripFromNotifications(){ try{ const data = await loadSheetGviz('Notification'); const cols=(data.table.cols||[]).map(c=> (c.label||c.id||'').toString().trim()); const rows=(data.table.rows||[]).map(r=> r.c || []); const textKey = cols.find(k=>/notif|notification|text|message|note|description/i.test(k))||cols[1]||cols[0]||'Notification'; const dateKey = cols.find(k=>/date|day|time/i.test(k))||cols[0]||'Date'; const strip = $('schoolStrip'); strip.innerHTML=''; const items=[]; rows.forEach(cells=>{ const obj={}; for(let i=0;i<cols.length;i++){ const cell=cells[i]; let v=''; if(cell){ if(cell.v!==undefined) v=cell.v; else if(cell.f!==undefined) v=String(cell.f).replace(/<[^>]*>/g,'').trim() } obj[cols[i]]=v } const t=obj[textKey]||''; const d=obj[dateKey]||''; if(t||d) items.push({date:d,text:t}) }); if(items.length===0){ const sp=document.createElement('div'); sp.className='school-chip'; sp.innerText='No notifications'; strip.appendChild(sp); return } function chip(it){ const txt=(it.date?it.date+' - ':'')+it.text; const short = txt.length>100?txt.slice(0,97)+'...':txt; const d=document.createElement('div'); d.className='school-chip'; d.title=txt; d.innerText=short; return d } items.forEach(it=> strip.appendChild(chip(it))); items.forEach(it=> strip.appendChild(chip(it))); startHeaderScroll(); const outer = document.querySelector('.strip-wrap'); outer.addEventListener('mouseenter', stopHeaderScroll); outer.addEventListener('mouseleave', startHeaderScroll) }catch(e){ console.error(e); $('schoolStrip').innerHTML='<div class=\"school-chip\">Unable to load</div>' } }

/* load notifications list */
async function loadNotifications(){ try{ const data = await loadSheetGviz('Notification'); const cols=(data.table.cols||[]).map(c=> (c.label||c.id||'').toString().trim()); const rows=(data.table.rows||[]).map(r=> r.c || []); const textKey = cols.find(k=>/notif|notification|text|message|note|description/i.test(k))||cols[1]||cols[0]||'Notification'; const dateKey = cols.find(k=>/date|day|time/i.test(k))||cols[0]||'Date'; const wrap=$('notifs'); wrap.innerHTML=''; rows.forEach(cells=>{ const obj={}; for(let i=0;i<cols.length;i++){ const cell=cells[i]; let v=''; if(cell){ if(cell.v!==undefined) v=cell.v; else if(cell.f!==undefined) v=String(cell.f).replace(/<[^>]*>/g,'').trim() } obj[cols[i]]=v } const d=obj[dateKey]||''; const t=obj[textKey]||''; const node=document.createElement('div'); node.className='notify-item'; node.innerHTML = `<div style="font-weight:700;color:var(--accent2)">${escapeHtml(d)}</div><div style="margin-top:6px">${escapeHtml(t)}</div>`; wrap.appendChild(node) }); const orig = wrap.children.length; for(let i=0;i<orig;i++){ wrap.appendChild(wrap.children[i].cloneNode(true)) } startNotifScroll(); const outer = $('notifyOuter'); outer.addEventListener('mouseenter', stopNotifScroll); outer.addEventListener('mouseleave', startNotifScroll) }catch(e){ console.error(e); $('notifs').innerHTML='<div style=\"padding:12px;color:var(--muted)\">Notification लोड नहीं हुए</div>' } }

/* load fee & marks */
async function loadFeeAndMarks(){ try{ const fee = await loadSheetGviz('Fee Student Details'); renderTableTo('feeContainer', fee) }catch(e){ console.error(e); $('feeContainer').innerHTML='<div style=\"padding:12px;color:var(--muted)\">Fee लोड नहीं हुए</div>' } try{ const marks = await loadSheetGviz('Marksheet Details'); renderTableTo('marksContainer', marks) }catch(e){ console.error(e); $('marksContainer').innerHTML='<div style=\"padding:12px;color:var(--muted)\">Marksheet लोड नहीं हुए</div>' } }

/* theme toggle */
const themeToggle = $('themeToggle');
themeToggle.addEventListener('click', ()=>{ document.documentElement.classList.toggle('light'); })

/* init */
document.getElementById('year').innerText = new Date().getFullYear();
showTab('fee');
buildStripFromNotifications();
loadNotifications();
loadFeeAndMarks();
</script>
</body>
</html>
